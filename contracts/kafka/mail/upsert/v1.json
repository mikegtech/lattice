{
	"$schema": "http://json-schema.org/draft-07/schema#",
	"$id": "lattice.mail.upsert.v1",
	"title": "Mail Upsert Event v1",
	"description": "Confirmation of vector upsert to Milvus",
	"type": "object",
	"properties": {
		"provider_message_id": {
			"type": "string",
			"description": "Gmail message ID"
		},
		"email_id": {
			"type": "string",
			"format": "uuid",
			"description": "Lattice-assigned unique email ID"
		},
		"chunk_id": {
			"type": "string",
			"format": "uuid",
			"description": "Unique chunk identifier"
		},
		"chunk_hash": {
			"type": "string",
			"description": "SHA-256 hash of the chunk text"
		},
		"embedding_id": {
			"type": "string",
			"format": "uuid",
			"description": "Unique embedding identifier"
		},
		"embedding_version": {
			"type": "string",
			"description": "Version of the embedding"
		},
		"milvus_collection": {
			"type": "string",
			"description": "Milvus collection name"
		},
		"milvus_partition": {
			"type": "string",
			"description": "Milvus partition (typically by account)"
		},
		"vector_id": {
			"type": "string",
			"description": "ID of the vector in Milvus"
		},
		"upserted_at": {
			"type": "string",
			"format": "date-time",
			"description": "When this vector was upserted"
		},
		"is_update": {
			"type": "boolean",
			"description": "Whether this was an update to an existing vector"
		}
	},
	"required": [
		"provider_message_id",
		"email_id",
		"chunk_id",
		"chunk_hash",
		"embedding_id",
		"embedding_version",
		"milvus_collection",
		"vector_id",
		"upserted_at",
		"is_update"
	],
	"additionalProperties": false
}
